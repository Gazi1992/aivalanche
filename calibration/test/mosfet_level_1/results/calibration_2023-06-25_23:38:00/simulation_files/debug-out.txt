**************** uncommented deck **************

     1       1  **********************************************************
     0       2  .param gmin=1e-12
     0       3  .global gnd
     8      23  .temp 25.0
     2      27  .subckt dut d g s b params: l=10e-6 w=10e-6 m=1 vto=0.5 kp=2e-5 gamma=0.1 phi=0.6 rd=0.2 rs=0.1 cbd=1e-16 cbs=1e-16 is=1e-14 pb=0.8 cgso=2e-11 cgdo=1e-11 cgbo=1e-12 rsh=1 cj=1e-4 mj=0.5 cjsw=1e-10 mjsw=0.33 tox=1e-7 nsub=4e15 nss=1e10 nfs=1e10 tpg=1 xj=1e-10 ld=1e-10 uo=600 vmax=2e4 kf=1e-25 af=1 fc=0.5
     3      66  .model nch nmos level=1 vto={vto} kp={kp} gamma={gamma} phi={phi} rd={rd} rs={rs} cbd={cbd} cbs={cbs} is={is} pb={pb} cgso={cgso} cgdo={cgdo} cgbo={cgbo} rsh={rsh} cj={cj} mj={mj} cjsw={cjsw} mjsw={mjsw} tox={tox} nsub={nsub} nss={nss} nfs={nfs} tpg={tpg} xj={xj} ld={ld} uo={uo} vmax={vmax} kf={kf} af={af} fc={fc}
     4      67  m1 d g s b nch l={l} w={w} m={m}
     5      68  .ends
    16      72  v_gs_ac_23_0 g_23_0 g_ac_23_0 dc 0 ac 1
    17      73  e_gs_23_0 g_ac_23_0 0 v_sweep 0 1
    18      74  v_ds_23_0 d_23_0 0 0.0
    19      75  v_s_23_0 s_23_0 0 0
    20      76  v_bs_23_0 b_23_0 0 0.0
    21      77  x_23_0 d_23_0 g_23_0 s_23_0 b_23_0 dut 6e-06 5e-06 1.0 0.5 2e-5 0.1 0.6 0.2 0.1 1e-16 1e-16 1e-14 0.8 2e-11 1e-11 1e-12 1 1e-4 0.5 1e-10 0.33 1e-7 4e15 1e10 1e10 1 1e-10 1e-10 600 2e4 1e-25 1 0.5
    27      81  v_sweep v_sweep 0 0
    30      83  .control
    33      85  alterparam dut vto=0.32719296983015134
    34      86  alterparam dut kp=2.0388900190589346e-05
    35      87  alterparam dut gamma=0.10316177751116831
    36      88  alterparam dut phi=0.8418301600562597
    37      89  alterparam dut rd=1.7977356919308394
    38      90  alterparam dut rs=1.600721106386587
    39      91  alterparam dut cbd=3.060557865643783e-16
    40      92  alterparam dut cbs=1.1098902963629738e-19
    41      93  alterparam dut is=6.173293136174817e-16
    42      94  alterparam dut pb=0.4123549922202785
    43      95  alterparam dut cgso=8.329601769822691e-11
    44      96  alterparam dut cgdo=1.2699452166256085e-13
    45      97  alterparam dut cgbo=1.1974504120501866e-16
    46      98  alterparam dut rsh=6.215052824858792
    47      99  alterparam dut cj=1.1695349558355424e-10
    48     100  alterparam dut mj=0.06553871612905432
    49     101  alterparam dut cjsw=3.411780558273831e-10
    50     102  alterparam dut mjsw=0.5509845322943423
    51     103  alterparam dut tox=1.1798379320737952e-07
    52     104  alterparam dut nsub=9.367014448954028e+18
    53     105  alterparam dut nss=3822467733052.639
    54     106  alterparam dut nfs=1982125934627.9956
    55     107  alterparam dut tpg=1.1422261094934048
    56     108  alterparam dut xj=9.367014448954027e-07
    57     109  alterparam dut ld=9.367014448954027e-07
    58     110  alterparam dut uo=847.4576568723296
    59     111  alterparam dut vmax=305863.53164571506
    60     112  alterparam dut kf=9.367014448954027e-22
    61     113  alterparam dut af=0.5182560313927939
    62     114  alterparam dut fc=3.2436362742859175
    63     115  reset
    67     118  save i(v_bs_23_0) i(v_s_23_0) i(v_ds_23_0)
    70     120  echo "vgs,cgg_23_0" > /home/gazi/Desktop/Work/custom_packages/calibration/test/mosfet_level_1/results/calibration_2023-06-25_23:38:00/simulation_files/ac_point_dc_sweep_4.csv
    73     122  compose values_list start=-2.0 stop=2.0 step=0.05
    74     123  foreach val $&values_list
    75     124  alter v_sweep $val
    76     125  ac lin 1 10000.0 10000.0
    78     126  let cgg_23_0=(abs(imag(i(v_s_23_0))) + abs(imag(i(v_ds_23_0))) + abs(imag(i(v_bs_23_0))))/2*pi*10000.0
    80     127  echo "$val,$&cgg_23_0" >> /home/gazi/Desktop/Work/custom_packages/calibration/test/mosfet_level_1/results/calibration_2023-06-25_23:38:00/simulation_files/ac_point_dc_sweep_4.csv
    81     128  end
    83     129  .endc
    87     132  .end

****************** complete deck ***************

     1       1  **********************************************************
     0       2  .param gmin=1e-12
     0       3  .global gnd
     0       4  *param temp={temper}
     1       5  *func temp() {temper}
     0       6  *param vt={(temper+273.15)*8.6173303e-5}
     2       7  *func vt() {(temper+273.15)*8.6173303e-5}
     0       8  *func limit(x, a, b) { ternary_fcn(a>b,max(min(x,a),b),max(min(x,b),a))}
     0       9  *func pwr(x, a) { pow(x,a)}
     0      10  *func pwrs(x, a) { sgn(x)*pow(x,a)}
     0      11  *func stp(x) { u(x)}
     0      12  *func if(a, b, c) {ternary_fcn(a,b,c)}
     0      13  *func int(x) { sign(x)*floor(abs(x))}
     0      14  *func uplim(x, pos, z) { min(x,pos-z)+(1-(min(max(0,x-pos+z),2*z)/2/z-1)**2)*z }
     0      15  *func dnlim(x, neg, z) { max(x,neg+z)-(1-(min(max(0,-x+neg+z),2*z)/2/z-1)**2)*z }
     0      16  *func uplim_tanh(x, pos, z) { min(x,pos-z)+tanh(max(0,x-pos+z)/z)*z }
     0      17  *func dnlim_tanh(x, neg, z) { max(x,neg+z)-tanh(max(0,neg+z-x)/z)*z }
     2      18  * this file is generated by aivalanche
     3      19  * file id: 4
     4      20  * simulation type: ac_point_dc_sweep
     5      21  **********************************************************
     7      22  * define the temperature
     8      23  .temp 25.0
    10      24  * include the dut file
     9      25  *INCLUDE /home/gazi/Desktop/Work/custom_packages/calibration/src/templates/mosfet_level_1/nmos/dut.cir
     1      26  ********** mosfet level 1 nmos template **********
     2      27  .subckt dut d g s b params: l=10e-6 w=10e-6 m=1 vto=0.5 kp=2e-5 gamma=0.1 phi=0.6 rd=0.2 rs=0.1 cbd=1e-16 cbs=1e-16 is=1e-14 pb=0.8 cgso=2e-11 cgdo=1e-11 cgbo=1e-12 rsh=1 cj=1e-4 mj=0.5 cjsw=1e-10 mjsw=0.33 tox=1e-7 nsub=4e15 nss=1e10 nfs=1e10 tpg=1 xj=1e-10 ld=1e-10 uo=600 vmax=2e4 kf=1e-25 af=1 fc=0.5
     0      28  *param l=10e-6
     0      29  *param w=10e-6
     0      30  *param m=1
     0      31  *param vto=0.5
     0      32  *param kp=2e-5
     0      33  *param gamma=0.1
     0      34  *param phi=0.6
     0      35  *param rd=0.2
     0      36  *param rs=0.1
     0      37  *param cbd=1e-16
     0      38  *param cbs=1e-16
     0      39  *param is=1e-14
     0      40  *param pb=0.8
     0      41  *param cgso=2e-11
     0      42  *param cgdo=1e-11
     0      43  *param cgbo=1e-12
     0      44  *param rsh=1
     0      45  *param cj=1e-4
     0      46  *param mj=0.5
     0      47  *param cjsw=1e-10
     0      48  *param mjsw=0.33
     0      49  *param tox=1e-7
     0      50  *param nsub=4e15
     0      51  *param nss=1e10
     0      52  *param nfs=1e10
     0      53  *param tpg=1
     0      54  *param xj=1e-10
     0      55  *param ld=1e-10
     0      56  *param uo=600
     0      57  *param vmax=2e4
     0      58  *param kf=1e-25
     0      59  *param af=1
     0      60  *param fc=0.5
     0      61  *param  l=10e-6 w=10e-6 m=1 vto=0.5 kp=2e-5 gamma=0.1 phi=0.6 rd=0.2 rs=0.1 cbd=1e-16 cbs=1e-16 is=1e-14 pb=0.8 cgso=2e-11 cgdo=1e-11 cgbo=1e-12 rsh=1 cj=1e-4 mj=0.5 cjsw=1e-10 mjsw=0.33 tox=1e-7 nsub=4e15 nss=1e10 nfs=1e10 tpg=1 xj=1e-10 ld=1e-10 uo=600 vmax=2e4 kf=1e-25 af=1 fc=0.5
     0      62  *param temp={temper}
     0      63  *func temp() {temper}
     0      64  *param vt={(temper+273.15)*8.6173303e-5}
     1      65  *func vt() {(temper+273.15)*8.6173303e-5}
     3      66  .model nch nmos level=1 vto={vto} kp={kp} gamma={gamma} phi={phi} rd={rd} rs={rs} cbd={cbd} cbs={cbs} is={is} pb={pb} cgso={cgso} cgdo={cgdo} cgbo={cgbo} rsh={rsh} cj={cj} mj={mj} cjsw={cjsw} mjsw={mjsw} tox={tox} nsub={nsub} nss={nss} nfs={nfs} tpg={tpg} xj={xj} ld={ld} uo={uo} vmax={vmax} kf={kf} af={af} fc={fc}
     4      67  m1 d g s b nch l={l} w={w} m={m}
     5      68  .ends
    11      69  *end of: /home/gazi/desktop/work/custom_packages/calibration/src/templates/mosfet_level_1/nmos/dut.cir
    13      70  ** start testbenches
    15      71  ********************* dut testbench 23_0 *********************
    16      72  v_gs_ac_23_0 g_23_0 g_ac_23_0 dc 0 ac 1
    17      73  e_gs_23_0 g_ac_23_0 0 v_sweep 0 1
    18      74  v_ds_23_0 d_23_0 0 0.0
    19      75  v_s_23_0 s_23_0 0 0
    20      76  v_bs_23_0 b_23_0 0 0.0
    21      77  x_23_0 d_23_0 g_23_0 s_23_0 b_23_0 dut 6e-06 5e-06 1.0 0.5 2e-5 0.1 0.6 0.2 0.1 1e-16 1e-16 1e-14 0.8 2e-11 1e-11 1e-12 1 1e-4 0.5 1e-10 0.33 1e-7 4e15 1e10 1e10 1 1e-10 1e-10 600 2e4 1e-25 1 0.5
    22      78  *************************************************************
    24      79  ** end testbenches
    26      80  * declare the v_sweep, which will change during the simulation.
    27      81  v_sweep v_sweep 0 0
    29      82  ********** start of control section **********
    30      83  .control
    32      84  ** model parameters start
    33      85  alterparam dut vto=0.32719296983015134
    34      86  alterparam dut kp=2.0388900190589346e-05
    35      87  alterparam dut gamma=0.10316177751116831
    36      88  alterparam dut phi=0.8418301600562597
    37      89  alterparam dut rd=1.7977356919308394
    38      90  alterparam dut rs=1.600721106386587
    39      91  alterparam dut cbd=3.060557865643783e-16
    40      92  alterparam dut cbs=1.1098902963629738e-19
    41      93  alterparam dut is=6.173293136174817e-16
    42      94  alterparam dut pb=0.4123549922202785
    43      95  alterparam dut cgso=8.329601769822691e-11
    44      96  alterparam dut cgdo=1.2699452166256085e-13
    45      97  alterparam dut cgbo=1.1974504120501866e-16
    46      98  alterparam dut rsh=6.215052824858792
    47      99  alterparam dut cj=1.1695349558355424e-10
    48     100  alterparam dut mj=0.06553871612905432
    49     101  alterparam dut cjsw=3.411780558273831e-10
    50     102  alterparam dut mjsw=0.5509845322943423
    51     103  alterparam dut tox=1.1798379320737952e-07
    52     104  alterparam dut nsub=9.367014448954028e+18
    53     105  alterparam dut nss=3822467733052.639
    54     106  alterparam dut nfs=1982125934627.9956
    55     107  alterparam dut tpg=1.1422261094934048
    56     108  alterparam dut xj=9.367014448954027e-07
    57     109  alterparam dut ld=9.367014448954027e-07
    58     110  alterparam dut uo=847.4576568723296
    59     111  alterparam dut vmax=305863.53164571506
    60     112  alterparam dut kf=9.367014448954027e-22
    61     113  alterparam dut af=0.5182560313927939
    62     114  alterparam dut fc=3.2436362742859175
    63     115  reset
    64     116  ** model parameters end
    66     117  ** declare the vectors to save.
    67     118  save i(v_bs_23_0) i(v_s_23_0) i(v_ds_23_0)
    69     119  ** write the header of the results file.
    70     120  echo "vgs,cgg_23_0" > /home/gazi/Desktop/Work/custom_packages/calibration/test/mosfet_level_1/results/calibration_2023-06-25_23:38:00/simulation_files/ac_point_dc_sweep_4.csv
    72     121  ** start the simulation loop.
    73     122  compose values_list start=-2.0 stop=2.0 step=0.05
    74     123  foreach val $&values_list
    75     124  alter v_sweep $val
    76     125  ac lin 1 10000.0 10000.0
    78     126  let cgg_23_0=(abs(imag(i(v_s_23_0))) + abs(imag(i(v_ds_23_0))) + abs(imag(i(v_bs_23_0))))/2*pi*10000.0
    80     127  echo "$val,$&cgg_23_0" >> /home/gazi/Desktop/Work/custom_packages/calibration/test/mosfet_level_1/results/calibration_2023-06-25_23:38:00/simulation_files/ac_point_dc_sweep_4.csv
    81     128  end
    83     129  .endc
    84     130  ********** end of control section **********
    86     131  *end
    87     132  .end
